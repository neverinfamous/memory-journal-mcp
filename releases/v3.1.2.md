# v3.1.2 - CI/CD Pipeline Fix

**Release Date:** January 11, 2026

## Fixed

### CI Build Pipeline

- **Added `.npmrc` with `legacy-peer-deps=true`** — Resolves `npm ci` failures caused by optional peer dependency conflicts (vectra's zod@^3.23.8 vs our zod@^4.x)
- **Root Cause**: The MCP SDK and vectra have differing zod peer dependencies, causing npm to fail strict peer dep resolution in CI
- **Symptom**: `npm ci` error: `Missing: zod@3.25.76 from lock file`

### Docker Workflow Gating

- **Added `preflight-check` job to docker-publish.yml** — Tag pushes now run lint/typecheck/build before Docker deployment
- **Root Cause**: Previous workflow condition `github.event_name == 'push'` bypassed lint-and-test on tag pushes
- **Fix**: Tag deployments now require preflight checks to pass before building Docker images

---

## Installation

**npm:**

```bash
npm install -g memory-journal-mcp@3.1.2
```

**Docker:**

```bash
docker pull writenotenow/memory-journal-mcp:3.1.2
```

---

## Links

- [Full Changelog](https://github.com/neverinfamous/memory-journal-mcp/wiki/CHANGELOG)
- [v3.1.0 Release Notes](https://github.com/neverinfamous/memory-journal-mcp/releases/tag/v3.1.0)
